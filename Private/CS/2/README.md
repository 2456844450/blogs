# 信息的表示和处理

现代计算机存储和处理的信息以二值信号表示。

## 信息存储

大多数计算机使用 8 位的块，或者字节（byte），作为最小的可寻址的内存单位，而不是访问内存中单独的位。机器级程序将内存视为一个非常大的字节数组，称为虚拟内存（virtual memory）。内存的每个字节都由一个唯一的数字来标识，称为它的地址（address），所有可能地址的集合就称为虚拟地址空间（virtual address space）。虚拟地址空间只是一个展现给机器级程序的概念性映像，实际的实现是将动态随机访问存储器（DRAM）、闪存、磁盘存储器、特殊硬件和操作系统结合起来，为程序提供一个看起来统一的字节数组。

例如，C 语言中一个指针的值就是某一个存储块的第一个字节的虚拟地址。

### 十六进制表示法

在 C 语言中，以 0x 或者 0X 开头的数字常量被认为是十六进制的值。

### 字数据大小

每台计算机都有一个字长（word size），指明指针数据的标称大小（nominal size）。因为虚拟地址是以这样的一个字来编码的，所以字长决定的最重要的系统参数就是虚拟地址空间的最大大小。

32 位字长限制虚拟地址空间为 4GB，扩展到 16 位字长使得虚拟地址空间为 16 EB。

大多数 64 位机器也可以运行为 32 位机器编译的程序，这是一种向后兼容。我们将程序称为 “32位程序” 或 “64位程序” 时，区别在于该程序是如何编译的（如下图），而不是其运行的机器类型。

程序员应该力图使他们的程序在不同机器和编译器上可移植。可移植性的一个方面就是使程序对不同数据类型的确切大小不敏感。

### 寻址和字节顺序

对于跨越多字节的程序对象，我们必须建立两个规则：这个对象的地址是什么，以及在内存中如何排列这些字节。在几乎所有的机器上，多字节对象都被存储为连续的字节序列，对象的地址为所使用字节中最小的地址。

排列表示一个对象的字节有两个通用的规则，某些机器选择在内存中按照从最低有效字节到最高有效字节的顺序存储对象，而另一些机器则按照从最高有效字节到最低有效字节的顺序存储。前一种规则，最低有效字节在前面的方式，称为小端法（little endian）。后一种规则，最高有效字节在前面的方式，称为大端法（big endian）。（如下图）

许多比较新的微处理器是“双端法（bi-endian）“，也就是说可以把它们配置成大端或者小端的机器运行。

网络应用程序的代码编写必须遵守已建立的关于字节顺序的规则，以确保发送方机器将它的内部表示转换成网络标准，而接收方机器则将网络标准转换为它的内部表示。

下面是不同机器上的字节表示（如下图）。

### 表示字符串

在使用 ASCII 码作为字符码的任何系统上都将得到相同的结果，与字节顺序和字节大小规则无关。因而，文本数据比二进制数据具有更强的平台独立性。

### 表示代码

从机器的角度来看，程序仅仅只是字节序列。不同的机器类型使用不同的且不兼容的指令和编码方式。即使是完全一样的进程，运行在不同的操作系统上也会有不同的编码规则，因此二进制代码是不兼容的。二进制代码很少能在不同机器和操作系统组合之间移植。

### 布尔代数

二进制是计算机编码、存储和操作信息的核心，将逻辑值 TRUE（真）和 FALSE（假）编码为二进制值 1 和 0，能够设计出一种代数，以研究逻辑推理的基本原则。

布尔代数的运算：

  - ~：~ 等于逻辑运算 NOT，当 P 等于 0 时，~P 等于 1，反之亦然；
  - &：& 等于逻辑运算 AND，只有当 p = 1 和 q = 1 时，p & q 才等于 1；
  - |：| 等于逻辑运算 OR，当 p = 1 或者 q = 1 时，p | q 等于 1；
  - ^：^ 等于逻辑运算 `异或`，当 p = 1 且 q = 0，或者 p = 0 且 q = 1 时，p ^ q 等于 1；

### C 语言的位级运算

C 语言的一个很有用的特性就是它支持按位布尔运算。实际上，我们在布尔运算中使用的那些符号就是 C 语言所使用的：| 就是 OR（或），& 就是 AND（与），~ 就是 NOT（取反），^ 就是 EXCLUSIVE-OR（异或）。

确定一个位级表达式的结果最好的办法，就是将十六进制的参数扩展成二进制表示并执行二进制运算，然后再转换回十六进制。（如下图）

### C 语言中的逻辑运算

C 语言还提供了一组逻辑运算符 ||、&& 和 !，分别对应命题逻辑中的 OR、AND 和 NOT 运算。（如下图）

### C 语言中的移位运算

C 语言还提供了一组移位运算，向左或向右移位模式：

  - x << k：左移位运算，x 向左移动 k 位，丢弃最高的 k 位，并在右端补 k 个 0；
  - x >> k：算术右移位运算，x 向右移动 k 位，丢弃最低的 k 位，并在左端补 k 个最高有效位的值；
  - x >>> k：逻辑右移位运算，x 向右移动 k 位，丢弃最低的 k 位，并在左端补 k 个 0；

案例（如下图）


## 整数表示

我们描述用位来编码整数的两种不同的方式：一种只能表示非负数，而另一种能够表示负数、零和正数。

下面列出了我们引入的数学术语，用于精确定义和描述计算机如何编码和操作整数。（如下图）

### 整型数据类型

C 语言标准规定了每种数据类型必须能够表示的最小的取值范围。（如下图）

> C 和 C++ 都支持有符号（默认）和无符号数。Java 只支持有符号数。

### 无符号数的编码

假设有一个整数数据类型有 w 位。我们可以将位向量写成 x^→，表示整个向量，或者写成 [x^w-1, x^w-2, ..., x^0]，表示向量中的每一位。把 x^→ 看做一个二进制表示的数，就获得了 x^→ 的无符号表示。在这个编码中，每个位 x^i 都取值为 0 或 1，后一种取值意味着数值 2^i 应为数字值的一部分。